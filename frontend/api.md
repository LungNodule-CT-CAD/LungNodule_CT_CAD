# **CT 肺结节检测系统 - 后端 API 文档**

## **1. 概述**
本文档为 CT 肺结节检测系统前端项目提供后端 API 规范。前端应用的核心功能依赖以下接口。

- **基础 URL**: 所有 API 路由都基于服务器根路径，例如 `http://localhost:5000`。
- **数据格式**: 所有请求和响应的主体都应为 `JSON` 格式，文件上传除外。

---

## **2. API 接口详解**

### **2.1 肺结节检测接口**

- **功能**: 接收前端上传的**单个 CT 图像文件**，对其进行分析，找出其中包含的肺结节，并返回它们的坐标信息。
- **URL**: `/api/detect-nodules`
- **方法**: `POST`
- **请求头**:
  - `Content-Type`: `multipart/form-data`
- **请求体 (Form Data)**:
  - `file`: (File) 用户选择的需要进行结节检测的图像文件。前端每次只会对**一张活动图像**发起检测请求。

- **成功响应 (200 OK)**:
  - **响应体 (JSON)**:
    ```json
    {
      "nodules": [
        { "id": 1, "x": 150, "y": 200, "width": 20, "height": 20 },
        { "id": 2, "x": 250, "y": 300, "width": 25, "height": 25 }
      ]
    }
    ```
    - `nodules`: (Array) 一个包含多个结节对象的数组。
      - `id`: (number) 结节的唯一标识符。
      - `x`: (number) 结节标注框左上角的 X 坐标。
      - `y`: (number) 结节标注框左上角的 Y 坐标。
      - `width`: (number) 标注框的宽度。
      - `height`: (number) 标注框的高度。

- **测试建议**: 这是测试的核心。后端收到文件后，**无需进行真实的模型推理**。只需**随机生成** 2 到 5 个结节对象，其 `x`, `y`, `width`, `height` 在合理的图像范围内随机取值，然后将这个数组返回即可。这可以非常方便地模拟出检测到不同数量和位置的结节的场景。

---

### **2.2 ~~图像上传接口~~ (已废弃)**

- **功能描述**: 原 `/api/upload` 接口已**废弃**。
- **原因**: 新的前端逻辑支持一次性上传多张图片，并在**客户端本地**直接生成预览图（使用 `FileReader` API 将图片转换为 Base64）。因此，不再需要一个独立的上传接口来返回处理后的图像数据。结节检测时，图像文件会直接通过 `/api/detect-nodules` 接口发送。

---

### **2.3 ~~调整窗宽窗位接口~~ (已废弃)**

- **功能描述**: 原 `/api/adjust-window` 接口已**废弃**。
- **原因**: 窗宽窗位（WW/WL）的调整目前仅在前端处理，不涉及后端请求。如果未来需要后端进行图像处理，则需要重新设计此接口。 