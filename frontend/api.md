# **后端 API 文档（2024升级版）**

本文档详细定义了 **CT 肺结节检测系统前端** 所依赖的后端 API 接口。前端通过这些接口与服务器进行通信，以实现核心的结节检测功能。

---

## **1. 概述**

-   **通信协议**: `HTTP/HTTPS`
-   **数据格式**: 请求体使用 `multipart/form-data`，响应体使用 `application/json`。
-   **错误处理**: API 应当遵循标准的 HTTP 状态码。例如，`200 OK` 表示成功，`4xx` 表示客户端错误，`5xx` 表示服务器错误。

---

## **2. 接口详解**

### **2.1. 肺结节检测**

-   **功能描述**:
    接收一个医学图像文件（如 DICOM），对其进行分析，并返回检测到的所有肺结节的**真实轮廓点集**。前端直接用canvas绘制轮廓，不再依赖cornerstone-tools标注。

-   **URL**: `/api/predict`

-   **请求方法**: `POST`

-   **请求头 (Headers)**:
    ```
    Content-Type: multipart/form-data
    ```

-   **请求体 (Body)**:
    请求体是一个 `FormData` 对象，包含以下字段：

| 字段名 | 类型 | 必需 | 描述 |
| :--- | :--- | :--- | :--- |
| `file` | File | 是 | 需要进行结节检测的图像文件。前端确保上传的是用户在界面上选择的当前活动图像。 |

-   **成功响应 (Success Response)**:
    -   **状态码**: `200 OK`
    -   **内容 (Body)**:
        返回一个 JSON 对象，其中包含一个名为 `nodules` 的数组，每个元素为一个结节对象：
        ```json
        {
          "nodules": [
            {
              "id": 1,
              "contour": [
                { "x": 100, "y": 120 },
                { "x": 102, "y": 121 },
                { "x": 105, "y": 123 }
                // ... 轮廓点集
              ]
            },
            {
              "id": 2,
              "contour": [
                { "x": 200, "y": 220 },
                { "x": 202, "y": 221 },
                { "x": 205, "y": 223 }
                // ... 轮廓点集
              ]
            }
          ]
        }
        ```
    -   **字段说明**:
| 字段名 | 类型 | 描述 |
| :--- | :--- | :--- |
| `id` | Number | 结节的唯一标识 |
| `contour` | Array | 结节真实轮廓点集，数组内每个元素为 `{x, y}` 坐标 |

---

## **3. 其他说明**
- 前端直接用canvas绘制所有结节轮廓，支持高亮、缩放、平移等交互。
- 轮廓点集为像素坐标，直接对应原始图像。